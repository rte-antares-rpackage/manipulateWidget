<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Add Controls to Interactive Plots — manipulateWidget â€¢ manipulateWidget</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">manipulateWidget</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/manipulateWidgets.html">Getting Started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../news/index.html">Change Log</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rte-antares-rpackage/manipulateWidget">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add Controls to Interactive Plots</h1>
    </div>

    
    <p>This function permits to add controls to an interactive plot created with
packages like <code>dygraphs</code>, <code>highcharter</code> or <code>plotly</code> in order
to change the input data or the parameters of the plot.</p>

    <p>Technically, the function starts a shiny gadget. The R session is bloqued
until the user clicks on &quot;cancel&quot; or &quot;done&quot;. If he clicks on &quot;done&quot;, then the
the function returns the last displayed plot so the user can modify it and/or
save it.</p>
    

    <pre><span class='fu'>manipulateWidget</span>(<span class='no'>.expr</span>, <span class='no'>...</span>, <span class='kw'>.main</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>.updateBtn</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>.controlPos</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"left"</span>, <span class='st'>"top"</span>, <span class='st'>"right"</span>, <span class='st'>"bottom"</span>, <span class='st'>"tab"</span>), <span class='kw'>.tabColumns</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>.viewer</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"pane"</span>, <span class='st'>"window"</span>, <span class='st'>"browser"</span>), <span class='kw'>.display</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>.updateInputs</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>.compare</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>.compareLayout</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"v"</span>, <span class='st'>"h"</span>))</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>.expr</dt>
      <dd>expression to evaluate that returns an interactive plot of class
<code>htmlwidget</code>. This expression is re-evaluated each time a control is
modified.</dd>
      <dt>...</dt>
      <dd>One or more named control arguments created with functions
<code><a href='mwSlider.html'>mwSlider</a></code>, <code><a href='mwText.html'>mwText</a></code>, etc. The name of each control
is the name of the variable the controls modifies in the expression. One
can also create a group of inputs by passing a list of such control
arguments. for instance <code>mygroup = list(txt = mwText(&quot;&quot;), nb =
mwNumeric(0))</code> creates a group of inputs named mygroup with two inputs
named &quot;txt&quot; and &quot;nb&quot;.</dd>
      <dt>.main</dt>
      <dd>Title of the shiny gadget</dd>
      <dt>.updateBtn</dt>
      <dd>Should an update button be added to the controls ? If
<code>TRUE</code>, then the graphic is updated only when the user clicks on the
update button.</dd>
      <dt>.controlPos</dt>
      <dd>Where controls should be placed ? By default, they are
placed in the left, next to the graphic. If <code>controlPos = &quot;tab&quot;</code>, two
tabs are created: one containing controls and the other containing the
graphic.</dd>
      <dt>.tabColumns</dt>
      <dd>If controls are placed in a distinct tab, how many columns
should be used ? This parameter is used only if <code>controlPos = &quot;tab&quot;</code></dd>
      <dt>.viewer</dt>
      <dd>Controls where the gadget should be displayed. <code>&quot;pane&quot;</code>
corresponds to the Rstudio viewer, <code>&quot;window&quot;</code> to a dialog window, and
<code>&quot;browser&quot;</code> to an external web browser.</dd>
      <dt>.display</dt>
      <dd>A named list of conditions that evaluate to TRUE OR FALSE
indicating when inputs should be displayed. These conditions are
reevaluated each time a control it modified. By default, each control is
displayed, but if the name of a control appears in this list, then the
associated condition is evaluated. If the result is TRUE then the control
is visible, else it is hidden.</dd>
      <dt>.updateInputs</dt>
      <dd>This parameter is similar to `.display` and can be used
to dynamically update input controls. It must be a named list where names
correspond to names of input controls and values are named lists of
expressions where names correspond to arguments of the input generator
function.</dd>
      <dt>.compare</dt>
      <dd>Sometimes one wants to compare the same chart but with two
different sets of parameters. This is the purpose of this argument. It must
be a named list whose names are the names of the inputs that should vary
between the two charts. All other parameters are common to the two charts
and changing their values will change the two charts. Each element of the
list must be a vector or a list of length 2 with the initial values of the
corresponding parameter for each chart. It can also be <code>NULL</code>. In this
case, the parameter is initialized with the default value for the two
charts.</dd>
      <dt>.compareLayout</dt>
      <dd>Used only when <code>.compare</code> is set. Possible values
are &quot;v&quot; for vertical layout (one chart above the other) and &quot;h&quot; for
horizontal layout (one chart on the right of the other)</dd>
    </dl>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The result of the expression evaluated with the last values of the controls.
It should be an object of class <code>htmlWidget</code>.</p>
    
    <h2 class="hasAnchor" id="advanced-usage"><a class="anchor" href="#advanced-usage"></a>Advanced Usage</h2>

    <p></p>
    <p>The &quot;normal&quot; use of the function is to provide an expression that always
return an <code>htmlwidget</code>. In such case, every time the user changes the
value of an input, the current widget is destroyed and a new one is created
and rendered.</p>
    <p>Some packages provide functions to update a widget that has already been
rendered. This is the case for instance for package <code>leaflet</code> with the
function <code><a href='http://www.rdocumentation.org/packages/leaflet/topics/leafletProxy'>leafletProxy</a></code>. To use such functions,
<code>manipulateWidget</code> evaluates the parameter <code>.expr</code> with four extra
variables:</p>
    <p><ul>
<li><code>.initial</code>:
    <code>TRUE</code> if the expression is evaluated for the first time and then
    the widget has not been rendered yet, <code>FALSE</code> if the widget has
    already been rendered.</p>
    <p></li>
<li><code>.session</code>:
    A shiny session object.</p>
    <p></li>
<li><code>.output</code>:
    ID of the output in the shiny interface.</p>
    <p></li>
<li><code>.id</code>:
    Id of the chart. It can be used in comparison mode to make further
    customization without the need to create additional input controls.</p>
    <p></li>
</ul></p>
    <p>You can take a look at the last example to see how to use these two
variables to update a leaflet widget.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='kw'>if</span> (<span class='fu'>require</span>(<span class='no'>dygraphs</span>)) {

  <span class='no'>mydata</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>year</span> <span class='kw'>=</span> <span class='fl'>2000</span>+<span class='fl'>1</span>:<span class='fl'>100</span>, <span class='kw'>value</span> <span class='kw'>=</span> <span class='fu'>rnorm</span>(<span class='fl'>100</span>))
  <span class='fu'>manipulateWidget</span>(<span class='fu'>dygraph</span>(<span class='no'>mydata</span>[<span class='no'>range</span>[<span class='fl'>1</span>]:<span class='no'>range</span>[<span class='fl'>2</span>] - <span class='fl'>2000</span>, ], <span class='kw'>main</span> <span class='kw'>=</span> <span class='no'>title</span>),
                   <span class='kw'>range</span> <span class='kw'>=</span> <span class='fu'><a href='mwSlider.html'>mwSlider</a></span>(<span class='fl'>2001</span>, <span class='fl'>2100</span>, <span class='fu'>c</span>(<span class='fl'>2001</span>, <span class='fl'>2100</span>)),
                   <span class='kw'>title</span> <span class='kw'>=</span> <span class='fu'><a href='mwText.html'>mwText</a></span>(<span class='st'>"Fictive time series"</span>))

}

<span class='co'># Comparison mode</span>
<span class='kw'>if</span> (<span class='fu'>require</span>(<span class='no'>dygraphs</span>)) {

  <span class='no'>mydata</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(
    <span class='kw'>year</span> <span class='kw'>=</span> <span class='fl'>2000</span>+<span class='fl'>1</span>:<span class='fl'>100</span>,
    <span class='kw'>series1</span> <span class='kw'>=</span> <span class='fu'>rnorm</span>(<span class='fl'>100</span>),
    <span class='kw'>series2</span> <span class='kw'>=</span> <span class='fu'>rnorm</span>(<span class='fl'>100</span>),
    <span class='kw'>series3</span> <span class='kw'>=</span> <span class='fu'>rnorm</span>(<span class='fl'>100</span>)
  )
  <span class='fu'>manipulateWidget</span>(
    <span class='fu'>dygraph</span>(<span class='no'>mydata</span>[<span class='no'>range</span>[<span class='fl'>1</span>]:<span class='no'>range</span>[<span class='fl'>2</span>] - <span class='fl'>2000</span>, <span class='fu'>c</span>(<span class='st'>"year"</span>, <span class='no'>series</span>)], <span class='kw'>main</span> <span class='kw'>=</span> <span class='no'>title</span>),
    <span class='kw'>range</span> <span class='kw'>=</span> <span class='fu'><a href='mwSlider.html'>mwSlider</a></span>(<span class='fl'>2001</span>, <span class='fl'>2100</span>, <span class='fu'>c</span>(<span class='fl'>2001</span>, <span class='fl'>2100</span>)),
    <span class='kw'>series</span> <span class='kw'>=</span> <span class='fu'><a href='mwSelect.html'>mwSelect</a></span>(<span class='fu'>c</span>(<span class='st'>"series1"</span>, <span class='st'>"series2"</span>, <span class='st'>"series3"</span>)),
    <span class='kw'>title</span> <span class='kw'>=</span> <span class='fu'><a href='mwText.html'>mwText</a></span>(<span class='st'>"Fictive time series"</span>),
    <span class='kw'>.compare</span> <span class='kw'>=</span> <span class='fu'>list</span>(
      <span class='kw'>title</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='st'>"First chart"</span>, <span class='st'>"Second chart"</span>),
      <span class='kw'>series</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
    )
  )
}

<span class='co'># Grouping inputs</span>
<span class='kw'>if</span> (<span class='fu'>require</span>(<span class='no'>dygraphs</span>)) {

  <span class='no'>mydata</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>year</span> <span class='kw'>=</span> <span class='fl'>2000</span>+<span class='fl'>1</span>:<span class='fl'>100</span>, <span class='kw'>value</span> <span class='kw'>=</span> <span class='fu'>rnorm</span>(<span class='fl'>100</span>))
  <span class='fu'>manipulateWidget</span>(<span class='fu'>dygraph</span>(<span class='no'>mydata</span>[<span class='no'>range</span>[<span class='fl'>1</span>]:<span class='no'>range</span>[<span class='fl'>2</span>] - <span class='fl'>2000</span>, ],
                           <span class='kw'>main</span> <span class='kw'>=</span> <span class='no'>title</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='no'>xlab</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='no'>ylab</span>),
                   <span class='kw'>range</span> <span class='kw'>=</span> <span class='fu'><a href='mwSlider.html'>mwSlider</a></span>(<span class='fl'>2001</span>, <span class='fl'>2100</span>, <span class='fu'>c</span>(<span class='fl'>2001</span>, <span class='fl'>2100</span>)),
                   <span class='st'>"Graphical parameters"</span> <span class='kw'>=</span> <span class='fu'>list</span>(
                      <span class='kw'>title</span> <span class='kw'>=</span> <span class='fu'><a href='mwText.html'>mwText</a></span>(<span class='st'>"Fictive time series"</span>),
                      <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='fu'><a href='mwText.html'>mwText</a></span>(<span class='st'>"X axis label"</span>),
                      <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='fu'><a href='mwText.html'>mwText</a></span>(<span class='st'>"Y axis label"</span>)
                   )
                  )

}

<span class='co'># Example of conditional input controls</span>
<span class='co'>#</span>
<span class='co'># In this example, we plot a x series against a y series. User can choose to</span>
<span class='co'># use points or lines. If he chooses lines, then an additional input is displayed</span>
<span class='co'># to let him control the width of the lines.</span>
<span class='kw'>if</span> (<span class='fu'>require</span>(<span class='st'>"plotly"</span>)) {

  <span class='no'>dt</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span> (
    <span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'>sort</span>(<span class='fu'>runif</span>(<span class='fl'>100</span>)),
    <span class='kw'>y</span> <span class='kw'>=</span> <span class='fu'>rnorm</span>(<span class='fl'>100</span>)
  )

  <span class='no'>myPlot</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>type</span>, <span class='no'>lwd</span>) {
    <span class='kw'>if</span> (<span class='no'>type</span> <span class='kw'>==</span> <span class='st'>"points"</span>) {
      <span class='fu'>plot_ly</span>(<span class='no'>dt</span>, <span class='kw'>x</span><span class='kw'>=</span> ~<span class='no'>x</span>, <span class='kw'>y</span> <span class='kw'>=</span> ~<span class='no'>y</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"scatter"</span>, <span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"markers"</span>)
    } <span class='kw'>else</span> {
      <span class='fu'>plot_ly</span>(<span class='no'>dt</span>, <span class='kw'>x</span><span class='kw'>=</span> ~<span class='no'>x</span>, <span class='kw'>y</span> <span class='kw'>=</span> ~<span class='no'>y</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"scatter"</span>, <span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"lines"</span>, <span class='kw'>line</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>width</span> <span class='kw'>=</span> <span class='no'>lwd</span>))
    }
  }

  <span class='fu'>manipulateWidget</span>(
    <span class='fu'>myPlot</span>(<span class='no'>type</span>, <span class='no'>lwd</span>),
    <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='mwSelect.html'>mwSelect</a></span>(<span class='fu'>c</span>(<span class='st'>"points"</span>, <span class='st'>"lines"</span>), <span class='st'>"points"</span>),
    <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fu'><a href='mwSlider.html'>mwSlider</a></span>(<span class='fl'>1</span>, <span class='fl'>10</span>, <span class='fl'>1</span>),
    <span class='kw'>.display</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>lwd</span> <span class='kw'>=</span> <span class='no'>type</span> <span class='kw'>==</span> <span class='st'>"lines"</span>)
  )

}

<span class='co'># Advanced Usage</span>
<span class='co'>#</span>
<span class='co'># .expr is evaluated with two extra variables .initial and .session that can</span>
<span class='co'># be used to update an already rendered widget instead of replacing it each</span>
<span class='co'># time an input value is modified.</span>
<span class='co'>#</span>
<span class='co'># Here we generate a UI that permits to change color and size of arbitrary</span>
<span class='co'># points on a map generated with leaflet.</span>

<span class='kw'>if</span> (<span class='fu'>require</span>(<span class='no'>leaflet</span>)) {
  <span class='no'>lon</span> <span class='kw'>&lt;-</span> <span class='fu'>rnorm</span>(<span class='fl'>10</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>20</span>)
  <span class='no'>lat</span> <span class='kw'>&lt;-</span> <span class='fu'>rnorm</span>(<span class='fl'>10</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>20</span>)

  <span class='no'>myMapFun</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>radius</span>, <span class='no'>color</span>, <span class='no'>initial</span>, <span class='no'>session</span>, <span class='no'>output</span>) {
    <span class='kw'>if</span> (<span class='no'>initial</span>) {
      <span class='co'># Widget has not been rendered</span>
      <span class='no'>map</span> <span class='kw'>&lt;-</span> <span class='fu'>leaflet</span>() <span class='kw'>%&gt;%</span> <span class='fu'>addTiles</span>()
    } <span class='kw'>else</span> {
      <span class='co'># widget has already been rendered</span>
      <span class='no'>map</span> <span class='kw'>&lt;-</span> <span class='fu'>leafletProxy</span>(<span class='no'>output</span>, <span class='no'>session</span>) <span class='kw'>%&gt;%</span> <span class='fu'>clearMarkers</span>()
    }

    <span class='no'>map</span> <span class='kw'>%&gt;%</span> <span class='fu'>addCircleMarkers</span>(<span class='no'>lon</span>, <span class='no'>lat</span>, <span class='kw'>radius</span> <span class='kw'>=</span> <span class='no'>radius</span>, <span class='kw'>color</span> <span class='kw'>=</span> <span class='no'>color</span>)
  }

  <span class='fu'>manipulateWidget</span>(<span class='fu'>myMapFun</span>(<span class='no'>radius</span>, <span class='no'>color</span>, <span class='no'>.initial</span>, <span class='no'>.session</span>, <span class='no'>.output</span>),
                   <span class='kw'>radius</span> <span class='kw'>=</span> <span class='fu'><a href='mwSlider.html'>mwSlider</a></span>(<span class='fl'>5</span>, <span class='fl'>30</span>, <span class='fl'>10</span>),
                   <span class='kw'>color</span> <span class='kw'>=</span> <span class='fu'><a href='mwSelect.html'>mwSelect</a></span>(<span class='fu'>c</span>(<span class='st'>"red"</span>, <span class='st'>"blue"</span>, <span class='st'>"green"</span>)))

}</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#advanced-usage">Advanced Usage</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Francois Guillem, <a href='http://www.rte-france.com'><img src='http://www.rte-france.com/sites/all/themes/rte/images/logo.png' height='24'/></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
